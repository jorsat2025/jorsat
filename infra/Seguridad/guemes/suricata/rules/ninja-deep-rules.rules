drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] DNS - malware domain suspiciousdomain.xyz"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"suspiciousdomain.xyz"; nocase; sid:9000017; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] DNS sospechoso - duckdns.org"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"duckdns.org"; endswith; nocase; sid:9100017; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] DNS sospechoso - dyndns.org"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"dyndns.org"; endswith; nocase; sid:9100019; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] DNS sospechoso - no-ip.com"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"no-ip.com"; endswith; nocase; sid:9100018; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - 1337x.org"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.1337x.org"; sid:9201007; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - btzoo.eu"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.btzoo.eu"; sid:9201006; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - ccc.de"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.ccc.de"; sid:9201009; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - eddie4.nl"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"www.eddie4.nl"; sid:9201004; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - glotorrents.pw"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"glotorrents.pw"; sid:9201002; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - gresille.org"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"torrent.gresille.org"; sid:9201001; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - h33t.com"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"fr33dom.h33t.com"; sid:9201010; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - istole.it"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.istole.it"; sid:9201008; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - leechers-paradise.org"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.leechers-paradise.org"; sid:9201005; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - openbittorrent.com"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.openbittorrent.com"; sid:9201011; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - publicbt.com"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.publicbt.com"; sid:9201012; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent UDP - trackerfix.com"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"tracker.trackerfix.com"; sid:9201003; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[NINJA] Suspicious TLD - .mov domain"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:".mov"; endswith; nocase; classtype:trojan-activity; sid:9000086; rev:1;)
drop drop dns $EXTERNAL_NET any -> $HOME_NET any ( msg:"[NINJA] Suspicious TLD - .zip domain"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:".zip"; endswith; nocase; classtype:trojan-activity; sid:9000085; rev:1;)
drop drop dns any any -> $HOME_NET any ( msg:"[DROP] DNS - arenabg tracker"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"arenabg.com"; nocase; classtype:trojan-activity; sid:9000013; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[NINJA] Suspicious JS dropper - loader.js or update.js"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"update.js"; http_uri; nocase; classtype:trojan-activity; sid:9000084; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - 9.rarbg.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"9.rarbg.com"; sid:9200004; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - aletorrenty.pl"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker.aletorrenty.pl"; sid:9200002; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - best-torrents.net"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker.best-torrents.net"; sid:9200008; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - bt.careland.com.cn"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"bt.careland.com.cn"; sid:9200005; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - coppersurfer.tk"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker.coppersurfer.tk"; sid:9200016; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - cpleft.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"cpleft.com"; sid:9200014; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - crunchbanglinux.org"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"bttracker.crunchbanglinux.org"; sid:9200001; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - demonoid.me"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"inferno.demonoid.me"; sid:9200017; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - exodus.desync.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"exodus.desync.com"; sid:9200019; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - explodie.org"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"explodie.org"; sid:9200006; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - harry.lu"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"ipv4.tracker.harry.lu"; sid:9200020; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - hotplug.ru"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"retracker.hotplug.ru"; sid:9200015; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - mgtracker.org"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"mgtracker.org"; sid:9200007; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - novalayer.org"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker.novalayer.org"; sid:9200013; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - pow7.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"pow7.com"; sid:9200012; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - retracker.kld.ru"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"retracker.kld.ru"; sid:9200003; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - tfile.me"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker.tfile.me"; sid:9200009; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - torrentbay.to"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker.torrentbay.to"; sid:9200021; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - torrentsmd.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"announce.torrentsmd.com"; sid:9200018; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - torrenty.org"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker.torrenty.org"; sid:9200010; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[DROP] Tracker BitTorrent - wasabii.com.tw"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"tracker1.wasabii.com.tw"; sid:9200011; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[NINJA] Possible data exfiltration via pastebin"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"pastebin.com"; http_uri; nocase; classtype:trojan-activity; sid:9000081; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[NINJA] Possible exfiltration via Discord webhook"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"discord.com/api/webhooks"; http_uri; nocase; classtype:trojan-activity; sid:9000080; rev:1;)
drop drop http $EXTERNAL_NET any -> $HOME_NET any ( msg:"[NINJA] Suspicious JS dropper - loader.js or update.js"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"loader.js"; http_uri; nocase; classtype:trojan-activity; sid:9000083; rev:1;)
drop drop http any any -> $HOME_NET 80 ( msg:"🚫 [DROP] Acceso HTTP no autorizado al puerto 80"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.method; content:"GET"; nocase; classtype:web-application-activity; sid:1000005; rev:3;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Acceso sospechoso - /admin/login.php"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"/admin/login.php"; nocase; sid:9101011; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Bot - User-Agent: curl"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.user_agent; content:"curl"; nocase; sid:8000002; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Bot - User-Agent: masscan"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.user_agent; content:"masscan"; nocase; sid:9000018; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Bot - User-Agent: python"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.user_agent; content:"python"; nocase; sid:8000001; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Bot - User-Agent: wget"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.user_agent; content:"wget"; nocase; sid:8000003; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Bot o script Python detectado"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.user_agent; content:"python"; nocase; sid:9100014; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Botnet detectado - User-Agent 'nmap'"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.user_agent; content:"nmap"; nocase; sid:9101012; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] CoinMiner detectado - coinhive"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"coinhive"; sid:9100004; rev:4;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] CoinMiner detectado - coinimp.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"coinimp.com"; sid:9100008; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] CoinMiner detectado - crypto-loot.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"crypto-loot.com"; sid:9100006; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] CoinMiner detectado - minexmr.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"minexmr.com"; sid:9100005; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] CoinMiner detectado - minexmr.com"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"minexmr.com"; sid:9100010; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] CoinMiner detectado - webmine.cz"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"webmine.cz"; sid:9100007; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Intento de acceso sospechoso - /admin"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"/admin"; nocase; sid:9100011; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Intento de ejecución remota - cmd="flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"cmd="; nocase; sid:9100012; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Malware - .exe descarga sospechosa"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:".exe"; nocase; sid:8000301; rev:2;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Phishing - login.php"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"login.php"; nocase; sid:8000200; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Phishing - webmail."flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"webmail."; sid:8000201; rev:2;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Posible C2 por Telegram detectado"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; content:"api.telegram.org"; sid:9100020; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Posible Phishing - secure-login"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"secure-login"; nocase; sid:9100016; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] RAT/C2 - /gate.php"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"/gate.php"; nocase; sid:8000300; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Scanner automatizado detectado - User-Agent masscan"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.user_agent; content:"masscan"; nocase; sid:9100013; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Shell web detectada - /shell.php"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"/shell.php"; nocase; sid:9101010; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Shell web detectada - cmd= ejecutado"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"cmd="; nocase; sid:9101009; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[DROP] Webshell detectado - shell.php"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.uri; content:"shell.php"; nocase; sid:9100015; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[JLB-NINJA] HTTP Body contains suspicious command"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"wget"; http_client_body; nocase; sid:9000056; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[JLB-NINJA] Intento de minado de criptomonedas vía web"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"coinhive"; http_uri; classtype:trojan-activity; priority:2; metadata:service http; sid:9000071; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[JLB-NINJA] Metasploit-like User-Agent detected"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"User-Agent"; http_header; content:"Meterpreter"; http_header; nocase; sid:9000054; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[JLB-NINJA] Possible RAT Command via HTTP"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"POST"; http_method; content:"/admin"; http_uri; sid:9000043; rev:2;)
drop drop http any any -> $HOME_NET any ( msg:"[JLB-NINJA] Suspicious URL with cmd= parameter"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"cmd="; http_uri; sid:9000053; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[JLB-NINJA] Suspicious curl or wget traffic"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"User-Agent"; http_header; content:"curl"; http_header; nocase; sid:9000052; rev:2;)
drop drop http any any -> $HOME_NET any ( msg:"[JLB-NINJA] Suspicious shell code in HTTP body"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; content:"/bin/sh"; http_client_body; nocase; sid:9000055; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[NINJA] Bot UA - python-requests detected"flow:to_server,established; app-layer-protocol:http;; http.user_agent; content:"python-requests"; nocase; sid:9000002; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[NINJA] BotNet UA - curl/wget"flow:to_server,established; app-layer-protocol:http;; flow:established,to_server; http.user_agent; content:"curl"; nocase; classtype:bad-unknown; sid:9000001; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[NINJA] Fake Steam domain"flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; pcre:"/steampowered\.su|steamcommunity\.xyz|steam.*login/"; sid:9000015; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[NINJA] Phishing Bank pattern"flow:to_server,established; app-layer-protocol:http;; http.uri; content:"login"; http.host; pcre:"/.*(ban|bank|banco)[a-z0-9]*\.com\.br/"; sid:9000026; rev:1;)
drop drop http any any -> $HOME_NET any ( msg:"[NINJA] Suspicious UA - masscan/zgrab"flow:to_server,established; app-layer-protocol:http;; http.user_agent; content:"zgrab"; nocase; sid:9000003; rev:1;)
drop drop tcp any any -> $HOME_NET any ( msg:"[NINJA] Suspicious phishing URL - .zip domain"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; flow:to_server,established; http.host; pcre:"/\.zip$/"; classtype:trojan-activity; sid:9000025; rev:2;)
drop drop udp any any -> any 53 ( msg:"[DROP] DNS - duckdns.org"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"duckdns.org"; endswith; nocase; sid:8000100; rev:1;)
drop drop udp any any -> any 53 ( msg:"[DROP] DNS - dyndns.org"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"dyndns.org"; endswith; nocase; sid:8000102; rev:1;)
drop drop udp any any -> any 53 ( msg:"[DROP] DNS - no-ip.com"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"no-ip.com"; endswith; nocase; sid:8000101; rev:1;)
drop drop udp any any -> any 53 ( msg:"[NINJA] DNS tunneling - long QNAME"content:"GET"; http_method; flow:to_server,established; app-layer-protocol:http;; dns.query; content:"."; content:"."; distance:1; within:255; pcre:"/([a-z0-9]{10,}\.){3,}/"; sid:9000010; rev:1;)
